<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>PSUWIT Admin - Market & Price Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <style>
        .logo-circle { border-radius: 50%; display: block; margin: 0 auto 1.5rem auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .price-card { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(51, 65, 85, 0.5); }
    </style>
</head>
<body class="bg-[#0b0f1a] text-white flex flex-col items-center justify-center min-h-screen p-6 font-sans">
    
    <div class="bg-slate-900 p-10 rounded-[3.5rem] border-4 border-dashed border-slate-800 text-center shadow-2xl w-full max-w-2xl flex flex-col items-center">
        <img src="https://img2.pic.in.th/pic/PSUWIT_Circle.png" class="logo-circle" width="130">
        
        <h1 class="text-yellow-500 text-4xl font-black italic uppercase tracking-tighter mb-1">PSU.WIT. WM</h1>
        <h2 class="text-slate-500 text-sm font-bold uppercase tracking-[0.3em] mb-8">Market Wheel Control</h2>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full mb-8">
            <div class="price-card p-4 rounded-2xl">
                <p class="text-[10px] text-blue-400 font-bold uppercase">PSUWIT STOCK</p>
                <p id="price-psuwit" class="text-xl font-mono font-bold text-white">‡∏ø100</p>
            </div>
            <div class="price-card p-4 rounded-2xl">
                <p class="text-[10px] text-orange-400 font-bold uppercase">BITCOIN (BTC)</p>
                <p id="price-btc" class="text-xl font-mono font-bold text-white">‡∏ø2,000,000</p>
            </div>
            <div class="price-card p-4 rounded-2xl">
                <p class="text-[10px] text-yellow-500 font-bold uppercase">GOLD (‡∏ó‡∏≠‡∏á)</p>
                <p id="price-gold" class="text-xl font-mono font-bold text-white">‡∏ø70,000</p>
            </div>
        </div>

        <div id="year-label" class="text-slate-500 font-black text-xl mb-1 uppercase tracking-widest">Ready</div>
        <div id="event-ui" class="text-5xl font-black text-white mb-10 uppercase tracking-tighter italic drop-shadow-lg">YEAR 0</div>
        
        <div class="flex flex-col gap-4 w-full max-w-sm">
            <button onclick="spin()" class="bg-blue-600 hover:bg-blue-500 p-6 rounded-3xl font-black text-2xl shadow-xl transition-all active:scale-95 uppercase tracking-wide">Random Year üé≤</button>
            <button onclick="reset()" class="text-slate-600 hover:text-rose-500 text-xs font-bold uppercase mt-6 transition-colors">Reset Global Game</button>
        </div>
    </div>

    <script>
        const firebaseConfig = { 
            apiKey: "AIzaSyDkewWSMrL538xerq70Ae90Svv8_p75Uks",
            authDomain: "psuwitwm.firebaseapp.com",
            databaseURL: "https://psuwitwm-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "psuwitwm",
            appId: "1:268031926990:web:c58f8695deebf4a5f6e69f" 
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let currentYear = 0;
        // ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin
        let adminPrices = { psuwit: 100, btc: 2000000, gold: 70000 };

        const eventPool = [
            { n: "Bull Run", m: {psuwit: 1.8, btc: 2.5, gold: 1.1, save: 1} },
            { n: "Crypto Winter", m: {psuwit: 1.1, btc: 0.15, gold: 1.2, save: 1} },
            { n: "Global War", m: {psuwit: 0.5, btc: 0.4, gold: 1.5, save: 1} },
            { n: "AI Revolution", m: {psuwit: 3.0, btc: 1.5, gold: 0.8, save: 1} },
            { n: "Hyper Inflation", m: {psuwit: 2.2, btc: 1.2, gold: 1.2, save: 1} },
            { n: "Market Crash", m: {psuwit: 0.15, btc: 0.3, gold: 1.4, save: 1} },
            { n: "Gold Discovery", m: {psuwit: 1.0, btc: 1.0, gold: 0.4, save: 1} },
            { n: "BTC Halving", m: {psuwit: 1.2, btc: 2.5, gold: 1.0, save: 1} },
            { n: "Space Tech Boom", m: {psuwit: 2.5, btc: 1.2, gold: 0.7, save: 1} },
            { n: "Tech Meltdown", m: {psuwit: 0.2, btc: 0.6, gold: 1.2, save: 1} },
            { n: "Stability Act", m: {psuwit: 1.05, btc: 1.05, gold: 1.05, save: 1} },
            { n: "Oil Crisis", m: {psuwit: 0.4, btc: 0.7, gold: 1.5, save: 1} },
            { n: "Peace Treaty", m: {psuwit: 1.5, btc: 1.2, gold: 0.6, save: 1} },
            { n: "Cyber Attack", m: {psuwit: 0.4, btc: 0.2, gold: 1.4, save: 1} },
            { n: "Green Energy", m: {psuwit: 2.4, btc: 1.0, gold: 0.5, save: 1} },
            { n: "Pandemic Strike", m: {psuwit: 0.7, btc: 1.5, gold: 1.3, save: 1} },
            { n: "Crypto Ban", m: {psuwit: 0.9, btc: 0.05, gold: 1.1, save: 1} },
            { n: "Tax Haven Leak", m: {psuwit: 0.8, btc: 1.5, gold: 1.3, save: 1} },
            { n: "Moon Mission", m: {psuwit: 3.0, btc: 6.0, gold: 0.05, save: 1} },
            { n: "Utopia State", m: {psuwit: 1.3, btc: 1.3, gold: 1.1, save: 1} }
        ];

        function spin() {
            currentYear++;
            const selected = eventPool[Math.floor(Math.random() * eventPool.length)];
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin
            adminPrices.psuwit *= selected.m.psuwit;
            adminPrices.btc *= selected.m.btc;
            adminPrices.gold *= selected.m.gold;

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Firebase
            db.ref('market_state').set({ 
                year: currentYear, 
                event: selected.n, 
                multi: selected.m, 
                ts: Date.now() 
            });

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Admin
            document.getElementById('year-label').innerText = `YEAR ${currentYear}`;
            document.getElementById('event-ui').innerText = selected.n;
            updatePriceDisplay();
        }

        function updatePriceDisplay() {
            document.getElementById('price-psuwit').innerText = `‡∏ø${adminPrices.psuwit.toLocaleString(undefined, {maximumFractionDigits:0})}`;
            document.getElementById('price-btc').innerText = `‡∏ø${adminPrices.btc.toLocaleString(undefined, {maximumFractionDigits:0})}`;
            document.getElementById('price-gold').innerText = `‡∏ø${adminPrices.gold.toLocaleString(undefined, {maximumFractionDigits:0})}`;
        }

        function reset() {
            if(confirm("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
                currentYear = 0;
                adminPrices = { psuwit: 100, btc: 2000000, gold: 70000 };
                db.ref('market_state').set({ year: 0, multi: {psuwit: 1, btc: 1, gold: 1, save: 1}, event: "Reset" });
                updatePriceDisplay();
                document.getElementById('year-label').innerText = "Ready";
                document.getElementById('event-ui').innerText = "YEAR 0";
            }
        }
        
        updatePriceDisplay();
    </script>
</body>
</html>
